{"componentChunkName":"component---src-templates-blog-post-template-js","path":"/blog/two-macbooks-one-bluetooth-speaker","result":{"data":{"markdownRemark":{"html":"<h2>Problem</h2>\n<p>I have 2 MacBooks and 1 Bluetooth speaker in my current desk setup, and it has been the bane of my existence since I resumed working from home.\nI use only 1 MacBook at a time, and I switch between them depending on what I'm working on. The speaker can connect to both MacBooks at the same time, but,\nand it's a big BUTT, I can't use Spotify on either machine if both are connected.\nIt's a weird issue with Spotify allowing you to control music with multiple devices so if I press \"play\" on one MacBook, the other MacBook will pause the music because\nit is also trying to play.</p>\n<p>And I'm not gonna remember to close Spotify and/or disconnect the speaker every time I switch between laptops, so... I did the developer thing and\nhad the AI write me a script that I spent the next day rewriting because it didn't work on the first, or second, or third try ðŸ˜‚.\nPlot twist, I had to do some manual research (sources linked below).</p>\n<blockquote>\n<p>This tutorial was written as of <code class=\"language-text\">sleepwatcher</code> version 2.2.1</p>\n</blockquote>\n<h4>Tip:</h4>\n<p><code class=\"language-text\">$</code> means run the command in your terminal (without the dollar sign)</p>\n<h2>Synopsis</h2>\n<p>It's a simple script that uses two packages, <code class=\"language-text\">blueutil</code> and <code class=\"language-text\">sleepwatcher</code>.</p>\n<h4><a href=\"https://github.com/toy/blueutil\">blueutil</a></h4>\n<ul>\n<li>Tool that allows you to control Bluetooth on macOS</li>\n<li>Can view devices, connect, disconnect, etc.</li>\n</ul>\n<h4><a href=\"https://www.bernhard-baehr.de/\">sleepwatcher</a></h4>\n<ul>\n<li>Tool that allows you to run scripts on sleep/wake events on macOS</li>\n</ul>\n<h2>Solution</h2>\n<ul>\n<li>\n<p>Install Homebrew if you don't have it already</p>\n<p><a href=\"https://brew.sh/\">https://brew.sh/</a></p>\n</li>\n<li>\n<p>Install <code class=\"language-text\">blueutil</code> and <code class=\"language-text\">sleepwatcher</code> using homebrew</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ brew <span class=\"token function\">install</span> blueutil sleepwatcher</code></pre></div>\n</li>\n<li>\n<p>Get the MAC address of your bluetooth device. It should be in the format (XX-XX-XX-XX-XX-XX)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ blueutil <span class=\"token parameter variable\">--paired</span></code></pre></div>\n</li>\n<li>\n<p>Create a <code class=\"language-text\">./sleep</code> file in your HOME directory (<code class=\"language-text\">cd ~</code>) and fill in the following to disconnect your bluetooth device</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash </span>\n<span class=\"token assign-left variable\">DEVICE_ADDRESS</span><span class=\"token operator\">=</span><span class=\"token string\">\"XX-XX-XX-XX-XX-XX\"</span>\nblueutil <span class=\"token parameter variable\">--disconnect</span> <span class=\"token variable\">$DEVICE_ADDRESS</span></code></pre></div>\n</li>\n<li>\n<p>Create a <code class=\"language-text\">./wakeup</code> file in your HOME directory (<code class=\"language-text\">cd ~</code>) and fill in the following to connect your bluetooth device</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token comment\"># Sleep for 10 seconds before attempting connection</span>\n<span class=\"token function\">sleep</span> <span class=\"token number\">10</span>\n<span class=\"token assign-left variable\">DEVICE_ADDRESS</span><span class=\"token operator\">=</span><span class=\"token string\">\"XX-XX-XX-XX-XX-XX\"</span>\nblueutil <span class=\"token parameter variable\">--connect</span> <span class=\"token variable\">$DEVICE_ADDRESS</span></code></pre></div>\n</li>\n<li>\n<p>Make the files executable</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~\n$ <span class=\"token function\">chmod</span> +x .sleep .wakeup</code></pre></div>\n</li>\n</ul>\n<h5>User Agent Setup (Required):</h5>\n<ul>\n<li>\n<p>Symlink the sample plist file (which already lists <code class=\"language-text\">.sleep</code> and <code class=\"language-text\">.wakeup</code> in the HOME directory, so no need to configure manually), to the <code class=\"language-text\">~/Library/LaunchAgents</code> directory to install the user agent</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">ln</span> <span class=\"token parameter variable\">-sfv</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>brew <span class=\"token parameter variable\">--cellar</span><span class=\"token variable\">)</span></span>/sleepwatcher/2.2.1/homebrew.mxcl.sleepwatcher.plist\"</span> ~/Library/LaunchAgents/</code></pre></div>\n<blockquote>\n<p>This tutorial was written as of <code class=\"language-text\">sleepwatcher</code> version 2.2.1 so the plist file may be different for you. Check the version you have installed by running <code class=\"language-text\">$ brew info sleepwatcher</code> and replace the version number in the command above with the version you have installed.</p>\n</blockquote>\n</li>\n<li>\n<p>Load the configuration with launchd</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ launchctl bootstrap gui/<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">id</span> <span class=\"token parameter variable\">-u</span><span class=\"token variable\">)</span></span> ~/Library/LaunchAgents/homebrew.mxcl.sleepwatcher.plist</code></pre></div>\n</li>\n</ul>\n<h5>System Agent Setup (Optional):</h5>\n<ul>\n<li>\n<p>Symlink the sample plist file (which already lists <code class=\"language-text\">.sleep</code> and <code class=\"language-text\">.wakeup</code> in the HOME directory, so no need to configure manually), to the <code class=\"language-text\">/Library/LaunchAgents</code> directory to install the system agent</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">ln</span> <span class=\"token parameter variable\">-sfv</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>brew <span class=\"token parameter variable\">--cellar</span><span class=\"token variable\">)</span></span>/sleepwatcher/2.2.1/homebrew.mxcl.sleepwatcher.plist\"</span> /Library/LaunchAgents/</code></pre></div>\n<blockquote>\n<p>This tutorial was written as of <code class=\"language-text\">sleepwatcher</code> version 2.2.1 so the plist file may be different for you. Check the version you have installed by running <code class=\"language-text\">$ brew info sleepwatcher</code> and replace the version number in the command above with the version you have installed.</p>\n</blockquote>\n</li>\n<li>\n<p>Load the configuration with launchd</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> launchctl bootstrap gui/<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">id</span> <span class=\"token parameter variable\">-u</span><span class=\"token variable\">)</span></span> /Library/LaunchAgents/homebrew.mxcl.sleepwatcher.plist</code></pre></div>\n</li>\n</ul>\n<p>And voila, you're done! ðŸŽ‰\nNow when one MacBook sleeps, it automatically disconnects from the speaker, and since I've run this setup on my other machine too, when it wakes up, it automatically connects to the speaker. And vice versa.</p>\n<h4>Sources:</h4>\n<ul>\n<li><a href=\"https://www.kodiakskorner.com/log/258\">https://www.kodiakskorner.com/log/258</a></li>\n</ul>\n<p>If you have any questions, feel free to hit me up on <a href=\"https://twitter.com/niiapa\">Twitter</a>.</p>","frontmatter":{"date":"2023-05-15","formattedDate":"15 May 2023","path":"/blog/two-macbooks-one-bluetooth-speaker","title":"Two MacBooks, One Bluetooth Speaker"}}},"pageContext":{}},"staticQueryHashes":["3496355619","68838506"],"slicesMap":{}}