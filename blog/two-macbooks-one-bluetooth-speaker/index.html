<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.9.1"/><meta data-react-helmet="true" name="description" content="A minii website"/><meta data-react-helmet="true" property="og:title" content="Two MacBooks, One Bluetooth Speaker | Blog"/><meta data-react-helmet="true" property="og:description" content="A minii website"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@niiapa"/><meta data-react-helmet="true" name="twitter:title" content="Two MacBooks, One Bluetooth Speaker | Blog"/><meta data-react-helmet="true" name="twitter:description" content="A minii website"/><meta name="theme-color" content="#141414"/><style data-href="/styles.713e800cfc3651c532c2.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css?family=Montserrat:500|Raleway:100,400&display=swap);@import url(https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css);code[class*=language-],pre[class*=language-]{word-wrap:break-word;background:#2f1e2e;color:#e7e9db;color:#a39e9b;direction:ltr;font-family:Consolas,Menlo,Monaco,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Courier New,Courier,monospace;-webkit-hyphens:none;hyphens:none;line-height:1.375;tab-size:4;text-align:left;white-space:pre;white-space:pre-wrap;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#4f424c}.token.punctuation{color:#a39e9b}.namespace{opacity:.7}.token.boolean,.token.null,.token.number,.token.operator{color:#f99b15}.token.property{color:#fec418}.token.tag{color:#06b6ef}.token.string{color:#5bc4bf}.token.selector{color:#815ba4}.token.attr-name{color:#f99b15}.language-css .token.string,.style .token.string,.token.entity,.token.url{color:#5bc4bf}.token.attr-value,.token.control,.token.directive,.token.keyword,.token.unit{color:#48b685}.token.atrule,.token.regex,.token.statement{color:#5bc4bf}.token.placeholder,.token.variable{color:#06b6ef}.token.important{color:#ef6155;font-weight:700}.token.entity{cursor:help}pre>code.highlight{outline:.4em solid red;outline-offset:.4em}*{box-sizing:border-box;margin:0;padding:0}body{background:#141414;color:#fff;display:flex;flex:1 1;flex-direction:row;flex-wrap:wrap;font-family:Raleway,sans-serif;font-size:1.1rem;justify-content:center;letter-spacing:1px}#___gatsby,body{width:100%}div[role=group][tabindex]{align-content:center;min-height:100vh}.container,div[role=group][tabindex]{display:flex;flex-direction:column;flex-wrap:wrap;width:100%}.container{flex:1 1;margin:auto;padding:0 10px 10px}main{display:flex;flex:1 1;flex-direction:column;flex-wrap:wrap;max-width:100%}h1,h2,h3,h4,h5,h6{font-family:Montserrat,sans-serif;line-height:normal}a:link,a:visited{color:#bfbfbf;text-decoration:none}a:active,a:hover{border-bottom:2px dashed #bfbfbf;color:#fff}.unstyled-link:active,.unstyled-link:hover{border:none}ul{padding-left:20px}nav ul{padding-left:0}footer,nav{flex-direction:column;flex-wrap:wrap;font-family:Montserrat,sans-serif;font-size:1.75rem;font-weight:700;margin:20px 0}footer li,nav li{list-style:none}footer{font-size:1.1rem;justify-content:flex-end;text-align:right}pre{background-color:#333;margin-bottom:10px;overflow-x:auto;padding:10px}pre code{padding:0}code{background-color:#333;color:#fff;font-family:Fira Code Retina,Fira Code,sans-serif;padding:0 3px}blockquote{background-color:#feba00;border-left:10px solid #ef9b10;color:#000;display:block;padding:5px}blockquote p{margin-left:5px}blockquote p:first-child{margin-top:0}blockquote p:last-child,blockquote pre{margin-bottom:0}.active-link{border-bottom:2px dashed #bfbfbf;color:#fff!important}.avatar{width:100px}.avatar img{border-radius:50%}.intro-box{border:2px dashed #bfbfbf;border-radius:4px;display:flex;flex:0 1;flex-direction:column;flex-wrap:wrap;margin-bottom:40px;padding:15px;position:relative}.intro-box .avatar{display:none}.intro-box p{padding:10px 0}.list{display:flex;flex-direction:column;flex-wrap:wrap}.list a:link,.list a:visited{color:#fff}.meta{display:inline;font-size:.75rem;font-weight:500;margin-right:10px}.meta:last-of-type{margin-right:0}.item{border:2px dashed transparent;border-radius:4px;flex:1 1;font-weight:lighter;margin-bottom:20px}.item:hover{border-color:#bfbfbf}.item-content{padding:10px}.about,.blog-post{border:2px dashed #bfbfbf;border-radius:4px;padding:17px;width:100%}.blog-post-content{line-height:22px;margin-top:20px}.blog-post-content h1,.blog-post-content h2,.blog-post-content h3,.blog-post-content h4,.blog-post-content h5,.blog-post-content h6{margin:35px 0 10px}.blog-post-content p{margin:20px 0}.blog-post-content .playlist{display:flex;flex-direction:row;justify-content:center;padding-top:15px}.blog-post-content a{word-wrap:break-word}.center{align-items:center;display:flex;flex:1 1;flex-direction:column;flex-wrap:wrap;text-align:center}@media (min-width:1024px){.container{padding:0;width:900px}.intro-box .avatar{display:inline;left:-120px;position:absolute;top:-3px;width:100px}footer li,nav li{display:inline;margin-right:30px}footer li:last-of-type,nav li:last-of-type{margin-right:0}footer{font-size:1.1rem}footer ul{display:flex;flex:1 1;flex-direction:row;flex-wrap:wrap;justify-content:space-between;padding:0}footer li{margin:0}}</style><title data-react-helmet="true">Two MacBooks, One Bluetooth Speaker | Blog | Nii Apa</title><link rel="icon" href="/favicon-32x32.png?v=0aa67ea7c54445de2ee0f87bbc645bf9" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=0aa67ea7c54445de2ee0f87bbc645bf9"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="container"><nav><ul><li><a href="/">Home</a></li><li><a href="/projects">Projects</a></li><li><a href="/photos">Photos</a></li><li><a href="/about">About</a></li></ul></nav><main><div class="blog-post"><h1>Two MacBooks, One Bluetooth Speaker</h1><div class="meta"><time dateTime="2023-05-15">15 May 2023</time></div><div class="blog-post-content"><h2>Problem</h2>
<p>I have 2 MacBooks and 1 Bluetooth speaker in my current desk setup, and it has been the bane of my existence since I resumed working from home.
I use only 1 MacBook at a time, and I switch between them depending on what I'm working on. The speaker can connect to both MacBooks at the same time, but,
and it's a big BUTT, I can't use Spotify on either machine if both are connected.
It's a weird issue with Spotify allowing you to control music with multiple devices so if I press "play" on one MacBook, the other MacBook will pause the music because
it is also trying to play.</p>
<p>And I'm not gonna remember to close Spotify and/or disconnect the speaker every time I switch between laptops, so... I did the developer thing and
had the AI write me a script that I spent the next day rewriting because it didn't work on the first, or second, or third try ðŸ˜‚.
Plot twist, I had to do some manual research (sources linked below).</p>
<blockquote>
<p>This tutorial was written as of <code class="language-text">sleepwatcher</code> version 2.2.1</p>
</blockquote>
<h4>Tip:</h4>
<p><code class="language-text">$</code> means run the command in your terminal (without the dollar sign)</p>
<h2>Synopsis</h2>
<p>It's a simple script that uses two packages, <code class="language-text">blueutil</code> and <code class="language-text">sleepwatcher</code>.</p>
<h4><a href="https://github.com/toy/blueutil">blueutil</a></h4>
<ul>
<li>Tool that allows you to control Bluetooth on macOS</li>
<li>Can view devices, connect, disconnect, etc.</li>
</ul>
<h4><a href="https://www.bernhard-baehr.de/">sleepwatcher</a></h4>
<ul>
<li>Tool that allows you to run scripts on sleep/wake events on macOS</li>
</ul>
<h2>Solution</h2>
<ul>
<li>
<p>Install Homebrew if you don't have it already</p>
<p><a href="https://brew.sh/">https://brew.sh/</a></p>
</li>
<li>
<p>Install <code class="language-text">blueutil</code> and <code class="language-text">sleepwatcher</code> using homebrew</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ brew <span class="token function">install</span> blueutil sleepwatcher</code></pre></div>
</li>
<li>
<p>Get the MAC address of your bluetooth device. It should be in the format (XX-XX-XX-XX-XX-XX)</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ blueutil <span class="token parameter variable">--paired</span></code></pre></div>
</li>
<li>
<p>Create a <code class="language-text">./sleep</code> file in your HOME directory (<code class="language-text">cd ~</code>) and fill in the following to disconnect your bluetooth device</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token shebang important">#!/bin/bash </span>
<span class="token assign-left variable">DEVICE_ADDRESS</span><span class="token operator">=</span><span class="token string">"XX-XX-XX-XX-XX-XX"</span>
blueutil <span class="token parameter variable">--disconnect</span> <span class="token variable">$DEVICE_ADDRESS</span></code></pre></div>
</li>
<li>
<p>Create a <code class="language-text">./wakeup</code> file in your HOME directory (<code class="language-text">cd ~</code>) and fill in the following to connect your bluetooth device</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># Sleep for 10 seconds before attempting connection</span>
<span class="token function">sleep</span> <span class="token number">10</span>
<span class="token assign-left variable">DEVICE_ADDRESS</span><span class="token operator">=</span><span class="token string">"XX-XX-XX-XX-XX-XX"</span>
blueutil <span class="token parameter variable">--connect</span> <span class="token variable">$DEVICE_ADDRESS</span></code></pre></div>
</li>
<li>
<p>Make the files executable</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> ~
$ <span class="token function">chmod</span> +x .sleep .wakeup</code></pre></div>
</li>
</ul>
<h3>User Agent Setup (Required):</h3>
<ul>
<li>
<p>Symlink the sample plist file (which already lists <code class="language-text">.sleep</code> and <code class="language-text">.wakeup</code> in the HOME directory, so no need to configure manually), to the <code class="language-text">~/Library/LaunchAgents</code> directory to install the user agent</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">ln</span> <span class="token parameter variable">-sfv</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span>brew <span class="token parameter variable">--cellar</span><span class="token variable">)</span></span>/sleepwatcher/2.2.1/homebrew.mxcl.sleepwatcher.plist"</span> ~/Library/LaunchAgents/</code></pre></div>
<blockquote>
<p>This tutorial was written as of <code class="language-text">sleepwatcher</code> version 2.2.1 so the plist file may be different for you. Check the version you have installed by running <code class="language-text">$ brew info sleepwatcher</code> and replace the version number in the command above with the version you have installed.</p>
</blockquote>
</li>
<li>
<p>Load the configuration with launchd</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ launchctl bootstrap gui/<span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">)</span></span> ~/Library/LaunchAgents/homebrew.mxcl.sleepwatcher.plist</code></pre></div>
</li>
</ul>
<h3>System Agent Setup (Optional):</h3>
<p><em>The difference between the user agent and the system agent is that the user agent runs when you log in, and the system agent runs when the computer starts up</em></p>
<ul>
<li>
<p>Symlink the sample plist file (which already lists <code class="language-text">.sleep</code> and <code class="language-text">.wakeup</code> in the HOME directory, so no need to configure manually), to the <code class="language-text">/Library/LaunchAgents</code> directory to install the system agent</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">ln</span> <span class="token parameter variable">-sfv</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span>brew <span class="token parameter variable">--cellar</span><span class="token variable">)</span></span>/sleepwatcher/2.2.1/homebrew.mxcl.sleepwatcher.plist"</span> /Library/LaunchAgents/</code></pre></div>
<blockquote>
<p>This tutorial was written as of <code class="language-text">sleepwatcher</code> version 2.2.1 so the plist file may be different for you. Check the version you have installed by running <code class="language-text">$ brew info sleepwatcher</code> and replace the version number in the command above with the version you have installed.</p>
</blockquote>
</li>
<li>
<p>Load the configuration with launchd</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">sudo</span> launchctl bootstrap gui/<span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">)</span></span> /Library/LaunchAgents/homebrew.mxcl.sleepwatcher.plist</code></pre></div>
</li>
</ul>
<p>And voila, you're done! ðŸŽ‰
Now when one MacBook sleeps, it automatically disconnects from the speaker, and since I've run this setup on my other machine too, when it wakes up, it automatically connects to the speaker. And vice versa.</p>
<h4>Sources:</h4>
<ul>
<li><a href="https://www.kodiakskorner.com/log/258">https://www.kodiakskorner.com/log/258</a></li>
</ul>
<p>If you have any questions, feel free to hit me up on <a href="https://twitter.com/niiapa">Twitter</a>.</p></div></div></main><footer><ul><li><a href="https://instagram.com/niiapa" target="_blank" rel="noopener noreferrer">instagram</a></li><li><a href="https://twitter.com/niiapa" target="_blank" rel="noopener noreferrer">twitter</a></li><li><a href="https://open.spotify.com/user/niiapa?si=oESrQQt-QuOSkawLRfFVZw" target="_blank" rel="noopener noreferrer">spotify</a></li><li><a href="https://github.com/niiapa" target="_blank" rel="noopener noreferrer">github</a></li></ul></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/two-macbooks-one-bluetooth-speaker";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-87d841bb837ad2b64cd8.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-20b675dcf58e48ba1762.js\"],\"component---src-pages-about-js\":[\"/component---src-pages-about-js-6b3b63d5fca35664e20f.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-8c8603f6a0003fbb72aa.js\"],\"component---src-pages-projects-js\":[\"/component---src-pages-projects-js-4156a6dca5c6fc950bda.js\"],\"component---src-templates-blog-post-template-js\":[\"/component---src-templates-blog-post-template-js-8f3852a8a5c4cc388be4.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="5c21e0c521b22ccce27b";</script><script src="/webpack-runtime-370e3b52a6cf42c5191b.js" async></script><script src="/framework-2f54d98921db07efcf6c.js" async></script><script src="/app-87d841bb837ad2b64cd8.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>